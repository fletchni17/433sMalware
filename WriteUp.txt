Text Write Up

Running it:

apt-get install libssl-dev
gcc Main.c -L/usr/lib -lssl -lcrypto -o main

Sources:

1) A Key-Management-Based Taxonomy for Ransomware


Notes for each of the main parts involved are below.


-------------------------------Obfuscation------------------------------------------------------------





------------------------------File Traversal----------------------------------------------------------

For right now, the plan for the malware is to attack files located in the running malware's current working
directory and stay at that depth(ie not recursively searching sub-directories). It wouldn't be hard to implement
that, but it seems unnecessary for the demo and might affect runtime.

As a safeguard against the malware going rogue on accident and encrypting important files on our computers
while testing, the malware will only encrypt a file if it has the keyword "malwareExample" in the file name.

--------------------------------Encryption------------------------------------------------------------
In source (1), a popular way that ransomwares use keys without exposing them to the client is detailed:

"This basic hybrid (symmetric+asymmetric) key model
 works in the following steps:
 1) Ransomware compromises host and commences execution.
 2) Cryptographic APIs available on the host are used to
 generate an encryption key such as an AES-256 key.
 3) Ransomware encrypts this symmetric key with a
 hard-coded asymmetric key (e.g. RSA-2048) and communicates a copy of the now encrypted symmetric key
 to the attacker.
 4) User data is encrypted using the symmetric key.
 5) Ransomware securely destroys the symmetric key on
 the host machine, now making the attacker the sole
 possessor of the decryption key.
 6) A ransom note is displayed to the user while ransomware awaits payment."


Generating public private pair using this website: https://cryptotools.net/rsagen

-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQBVsejWJHjJO/VCu+vJj6QklpPbZODP+A4e2ZYOf4sGt+ce/7+A
P9YKFmaWAXhd1LOb9mfzngRCNGIzJBNOssNBPJXie5wT7EbXKJ1YsH/3Efnp57DE
WaeLe/LwIUfe2+ufzNIZhCKDdKSItFaSQ0yO4ylXU8SCp6HxCGbdTw0EXat2wEs2
vXRRXxG06EjfMjwSEnygr0WKBAzHHYOFm6dNnlZyisYupd1a2lD9Ip5w/6lh9z2R
Rz4BoX9GI3XHW4mm+qeW2aF3i6QdI2mu8CnjQIPilqcKabx2jX7n8wHgf0rUcQyj
7b3nEo1fBhtQO29VgffawI8uQian7Tg8Vk7xAgMBAAECggEAM7tZ7uRHklvCvI2L
UruHAJtyGNC2MnXxuEfsIUZ3nA+q03jal0ZyJNbPCSFME4DTCITgzh2HPpw2596Q
VULvQlObvASY/SH2xe57xk2Ogo10i/LVMENbNIYX60R8CZpDjM1ty/+LgkYJCYms
dVFxRxT1IQWtrJ4b0dEbn+AX4Jkjjsgkf1gHAYAz8p9MAyGD1RTmRLqwJvTYj1o3
UTcUI8BJh/jl+qX9B52WB2qxqEuPgzP4Hv9dnLOQt9Y5VLwGhqkbU5ciNp3Gxyu+
64cNNA/bMFqYlo0O486P6ZZID+CXHOf8KfscvgIRMkgBVe8UWxD1k46vuVhacgtZ
QSYc0QKBgQCk0HMY5cdljeoH/TLakwDz2GFUxJ6yDghOV/yzr/5H2H84q7B2UXrc
TvihytvOAS+gTYw2vqBwX0lgKnWzGb/lNyj25RblCriprrVlmkmH5B43ISg1gZ/5
tEhoSLWAKzNOQ8hXgB7v405tFrw0e16eDrYxp2AVuBIjd2s88APqbQKBgQCFG1u6
WLJb6P+wZbXkg7AvgopyHPxI58j9q78/t2Tf/hCEQF6eV+rPeHSwFt5Z0pRytyCC
EFpaxBgd/8BqFOqvxoW0eAAUWBDztWqUVH2ueKwwS87+OcOLyoyn8kOzjrA+WXGn
i5BHvZe6t1S3eQ9nSslPqs4CLkPq6/wEV0fkFQKBgQCFhldpGWeU8Adll41mpWhF
Jc2c5nqHWHUEO6aAURoaTNytJfOdt99osxYdxgKUAEP8hDcPdxr2T0xb+6pFgpwD
8M9gTzNgNnJrDh7qBLiDvp14HoW765uWqqdqzVU2VEmJo8KgmSz3PlmgaaXqgvSh
6ttSmP5wOiN/1lTsFquldQKBgGhCo7j1HNANU6pSIQWbePfd4p+7wIlCtRat3qID
/snM8hcFbJfO+agFDDGZ2BS3c3vfoWD/eia6jsGAwLDXLXT9pWFU1YsZ6D1dDtyc
yc1NzGIQH1TW3iqzPzWV+B2/WKGd4f6AvUTUZvLkA0GrW7tmwwTaH39pyd1Ldx3X
WAJ5AoGAccHW3PlZBhz5kjPvhJUojm68j3k1P+3f7SbWz3G9vyYxLMHxyzgJcGRs
5zqXwrEl1IFnibVCDxIN/nlpBRchzSCqqYpw25chxvlgyHqCSdlQgS/N6clDbdLH
tIiiuPEbwEyy6iFTYbXLkUzP6ZEqT3kHDULOeP5zl1usVwVB8aQ=
-----END RSA PRIVATE KEY-----

-----BEGIN PUBLIC KEY-----
MIIBITANBgkqhkiG9w0BAQEFAAOCAQ4AMIIBCQKCAQBVsejWJHjJO/VCu+vJj6Qk
lpPbZODP+A4e2ZYOf4sGt+ce/7+AP9YKFmaWAXhd1LOb9mfzngRCNGIzJBNOssNB
PJXie5wT7EbXKJ1YsH/3Efnp57DEWaeLe/LwIUfe2+ufzNIZhCKDdKSItFaSQ0yO
4ylXU8SCp6HxCGbdTw0EXat2wEs2vXRRXxG06EjfMjwSEnygr0WKBAzHHYOFm6dN
nlZyisYupd1a2lD9Ip5w/6lh9z2RRz4BoX9GI3XHW4mm+qeW2aF3i6QdI2mu8Cnj
QIPilqcKabx2jX7n8wHgf0rUcQyj7b3nEo1fBhtQO29VgffawI8uQian7Tg8Vk7x
AgMBAAE=
-----END PUBLIC KEY-----

---------------------------------Spreading---------------------------------------------------------------